---
layout: post
title: Ubuntu Server 镜像制作过程
category: ubuntu
---

h2. 引出

最近要将爬虫部署到集群上，故先在虚拟机上配置好一个系统镜像，再批量安装到集群上

h2. 软件环境

* Windows 7
* VMware 7
* Ubuntu Server 12.04
* JDK 7
* Hadoop 0.20.2

h2. Step1 

把 Ubuntu Server 12.04 的 iso 镜像安装到虚拟机上

h2. Step2 Network connection

虚拟机提供了4种网络连接方式，下面主要讲解前两种:

* Bridged
* NAT
* Host-only
* Custom

h3. Bridged 桥接

配置成桥接网络连接模式的虚拟机就当作主机所在以太网的一部分，虚拟系统和宿主机器的关系，就像连接在同一个 Hub 上的两台电脑，可以像主机一样可以访问以太网中的所有共享资源和网络连接，可以直接共享主机网络的互联网接入线路访问互联网。主机与虚拟机之间，以及各虚拟机之间都可以互访。对应虚拟机就被当成主机所在以太网上的一个独立物理机来看待，各虚拟机通过默认的 VMnet0 网卡与主机以太网连接，虚拟机间的虚拟网络为 VMnet0 。这时你的虚拟机就像局域网中的一个独立的物理机一样。虚拟机中的操作系统可以 PING 通别的主机，反过来别的主机也可以 PING 虚拟机。想让它们相互通讯，你就需要为虚拟系统配置 IP 地址和子网掩码，否则就无法通信。

!/images/ubuntu/Bridged.gif!

h3. NAT 

使用 NAT 模式，就是让虚拟系统借助 NAT (网络地址转换)功能，通过宿主机器所在的网络来访问公网。也就是说，使用 NAT 模式可以实现在虚拟系统里访问互联网。NAT 模式下的虚拟系统的 TCP/IP 配置信息是由 VMnet8(NAT) 虚拟网络的 DHCP 服务器提供的，无法进行手工修改，因此虚拟系统也就无法和本局域网中的其他真实主机进行通讯。采用NAT模式最大的优势是虚拟系统接入互联网非常简单，你不需要进行任何其他的配置，只需要宿主机器能访问互联网即可。

!/images/ubuntu/NAT.gif!

h2. 转生

Ubuntu 下有一个自带的 OpenJDK，但是不怎么好用，一般都还是会安装 JDK，因为 Oracle 收购了 SUN 公司，Java 也随之嫁到了 Oracle。故下面的这条命令不能用了：

{% highlight bash linenos %}
$ sudo apt-get install sun-java6-jdk
{% endhighlight %}